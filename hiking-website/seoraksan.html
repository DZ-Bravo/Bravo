<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì„¤ì•…ì‚° - ì˜¤ëŠ˜ì˜ ë“±ì‚°</title>
  <style>
    :root {
      --primary: #2d8659;
      --accent: #1e5d3f;
      --bg: #f8f9fa;
      --text-main: #212529;
      --text-muted: #6c757d;
      --border: #dee2e6;
      --card-bg: #ffffff;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
      line-height: 1.6;
    }
    .header {
      background: var(--card-bg);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .icon-btn {
      width: 40px;
      height: 40px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }
    .icon-btn:hover {
      background: var(--bg);
    }
    .mountain-image {
      width: 100%;
      height: 400px;
      object-fit: cover;
    }
    .mountain-info {
      background: var(--card-bg);
      padding: 24px 16px;
      margin-top: -20px;
      border-radius: 20px 20px 0 0;
      position: relative;
    }
    .mountain-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    .mountain-title h1 {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--text-main);
    }
    .mountain-meta {
      font-size: 1rem;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    .badge {
      display: inline-block;
      padding: 4px 12px;
      background: var(--primary);
      color: #fff;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
    }
    .mountain-desc {
      color: var(--text-main);
      font-size: 0.95rem;
      line-height: 1.6;
      margin-bottom: 16px;
    }
    .certification {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      margin: 16px 0;
    }
    .certification-text {
      font-size: 0.9rem;
      color: var(--text-main);
    }
    .info-card {
      background: var(--card-bg);
      padding: 16px;
      margin: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .info-card-icon {
      font-size: 1.5rem;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      background: var(--bg);
    }
    .info-card-content {
      flex: 1;
    }
    .info-card-title {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 4px;
    }
    .info-card-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .info-card-arrow {
      font-size: 1.2rem;
      color: var(--text-muted);
    }
    .weather-section {
      background: var(--card-bg);
      padding: 20px 16px;
      margin: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .weather-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    .weather-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-main);
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .weather-source {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .weather-forecast {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding-bottom: 8px;
      margin-bottom: 16px;
    }
    .weather-day {
      min-width: 70px;
      text-align: center;
    }
    .weather-day-name {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 8px;
    }
    .weather-icon {
      font-size: 2rem;
      margin-bottom: 8px;
    }
    .weather-temp {
      font-size: 0.85rem;
      color: var(--text-main);
      margin-bottom: 4px;
    }
    .weather-wind {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .weather-precipitation {
      font-size: 0.75rem;
      color: #0066cc;
      margin-top: 4px;
    }
    .sun-info {
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      border-top: 1px solid var(--border);
      margin-top: 16px;
    }
    .sun-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      color: var(--text-main);
    }
    .sun-reference {
      font-size: 0.7rem;
      color: var(--text-muted);
      text-align: center;
      margin-top: 8px;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    .map-section {
      background: var(--card-bg);
      padding: 20px 16px;
      margin: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .map-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    .map-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-main);
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .course-suggest-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      color: var(--primary);
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
    }
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      border-radius: 8px;
      background: var(--bg);
      color: var(--text-muted);
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
    }
    .tab.active {
      background: var(--text-main);
      color: #fff;
    }
    .map-container {
      width: 100%;
      height: 400px;
      background: var(--bg);
      border-radius: 8px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }
    #course-map {
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    .map-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 0.9rem;
    }
    .course-list-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }
    .course-count {
      font-size: 0.9rem;
      color: var(--text-main);
      font-weight: 500;
    }
    .sort-options {
      display: flex;
      gap: 8px;
    }
    .sort-btn {
      padding: 4px 8px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 4px;
      font-size: 0.8rem;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }
    .sort-btn.active {
      border-color: var(--primary);
      color: var(--primary);
    }
    .course-item {
      background: var(--card-bg);
      padding: 16px;
      margin-bottom: 12px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .course-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .course-item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    .course-name {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-main);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .course-popular-badge {
      background: var(--primary);
      color: #fff;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.7rem;
      font-weight: 500;
    }
    .course-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    .course-meta {
      display: flex;
      gap: 16px;
      font-size: 0.85rem;
      color: var(--text-muted);
    }
    .course-meta-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .difficulty {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .difficulty-bar {
      display: flex;
      gap: 2px;
    }
    .difficulty-bar span {
      width: 4px;
      height: 12px;
      background: var(--border);
      border-radius: 2px;
    }
    .difficulty-bar span.filled {
      background: var(--primary);
    }
    .origin-section {
      background: var(--card-bg);
      padding: 20px 16px;
      margin: 12px 16px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .origin-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .origin-content {
      font-size: 0.95rem;
      color: var(--text-main);
      line-height: 1.8;
    }
    .origin-content p {
      margin-bottom: 12px;
    }
    .origin-content p:last-child {
      margin-bottom: 0;
    }
    .origin-highlight {
      color: var(--primary);
      font-weight: 600;
    }
    .view-all-mountains-btn {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: calc(100% - 32px);
      max-width: 600px;
      padding: 16px;
      background: var(--card-bg);
      border: 1px solid var(--primary);
      border-radius: 12px;
      margin: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 1rem;
      font-weight: 500;
      color: var(--text-main);
      cursor: pointer;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      transition: all 0.2s;
    }
    .view-all-mountains-btn:hover {
      background: var(--primary);
      color: #fff;
    }
    .view-all-mountains-btn-icon {
      font-size: 1.2rem;
    }
    body {
      padding-bottom: 80px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-left">
      <button class="icon-btn" onclick="history.back()">â†</button>
      <button class="icon-btn" onclick="window.location.href='index.html'">ğŸ </button>
    </div>
    <div class="header-right">
      <button class="icon-btn">ğŸ“¤</button>
      <button class="icon-btn">â‹¯</button>
    </div>
  </div>

  <img src="https://images.unsplash.com/photo-1551632811-561732d1e306?auto=format&fit=crop&w=1200&q=80" alt="ì„¤ì•…ì‚°" class="mountain-image" />

  <div class="mountain-info">
    <div class="mountain-title">
      <div>
        <h1>ì„¤ì•…ì‚°</h1>
        <div class="mountain-meta">1,708m Â· ê°•ì›</div>
      </div>
      <span class="badge">êµ­ë¦½ê³µì›</span>
    </div>
    <p class="mountain-desc">
      í•œë°˜ë„ì—ì„œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ì‚°<br>
      ì„¤ì•…ì‚°ì—ì„œ ë§Œë‚˜ëŠ” ìì—°ì˜ ê²½ì´ë¡œì›€
    </p>
    <div class="certification">
      <span class="certification-text">ì¸ì¦ê°€ëŠ¥ 3</span>
      <span style="color: var(--text-muted);">></span>
    </div>

    <div class="origin-section">
      <div class="origin-title">
        ğŸ“– ì‚° ìœ ë˜
      </div>
      <div class="origin-content">
        <p>
          ì„¤ì•…ì‚°ì€ <span class="origin-highlight">ëˆˆì²˜ëŸ¼ í•˜ì–€ ë°”ìœ„</span>ê°€ ë§ì•„ì„œ ì„¤ì•…ì‚°(é›ªå¶½å±±)ì´ë¼ê³  ë¶ˆë¦¬ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
        </p>
        <p>
          ê³ ë ¤ ì‹œëŒ€ì—ëŠ” <span class="origin-highlight">ì„¤ì•…ì‚°</span> ë˜ëŠ” <span class="origin-highlight">ì„¤ë´‰ì‚°(é›ªå³°å±±)</span>ì´ë¼ê³  ë¶ˆë ¸ê³ , ì¡°ì„  ì‹œëŒ€ì—ëŠ” <span class="origin-highlight">ì„¤ì•…ì‚°</span>ì´ë¼ëŠ” ì´ë¦„ì´ ë„ë¦¬ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.
        </p>
        <p>
          ì„¤ì•…ì‚°ì€ <span class="origin-highlight">ëŒ€ì²­ë´‰(1,708m)</span>ì„ ì£¼ë´‰ìœ¼ë¡œ í•˜ë©°, í•œë°˜ë„ì—ì„œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ì‚°ìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤. ë´„ì˜ ì§„ë‹¬ë˜, ì—¬ë¦„ì˜ í‘¸ë¥¸ ìˆ², ê°€ì„ì˜ ë‹¨í’, ê²¨ìš¸ì˜ ì„¤ê²½ìœ¼ë¡œ ì‚¬ê³„ì ˆ ë‚´ë‚´ ì•„ë¦„ë‹¤ìš´ í’ê²½ì„ ìë‘í•©ë‹ˆë‹¤.
        </p>
        <p>
          1970ë…„ êµ­ë¦½ê³µì›ìœ¼ë¡œ ì§€ì •ë˜ì—ˆìœ¼ë©°, í˜„ì¬ëŠ” ì„¸ê³„ì ìœ¼ë¡œë„ ìœ ëª…í•œ ê´€ê´‘ì§€ì´ì ë“±ì‚° ëª…ì†Œë¡œ ìë¦¬ì¡ì•˜ìŠµë‹ˆë‹¤.
        </p>
      </div>
    </div>

    <div class="info-card">
      <div class="info-card-icon" style="background: #ffe5e5; color: #ff4444;">ğŸ””</div>
      <div class="info-card-content">
        <div class="info-card-title">ì‹¤ì‹œê°„ í†µì œì •ë³´</div>
        <div class="info-card-desc">
          ì„¤ì•…ì‚° â€¢ ë¶€ë¶„í†µì œ<br>
          ì„¤ì•…ì‚°ëŒ€ì²­ë´‰ â€¢ ë¶€ë¶„í†µì œ
        </div>
      </div>
      <div class="info-card-arrow">></div>
    </div>

    <a href="https://www.knps.or.kr/common/cctv/cctv4.do" target="_blank" class="info-card">
      <div class="info-card-icon" style="background: #e5f3ff; color: #0066cc;">ğŸ¥</div>
      <div class="info-card-content">
        <div class="info-card-title">ì‹¤ì‹œê°„ CCTV</div>
        <div class="info-card-desc">ì„¤ì•…ì‚°(ëŒ€ì²­ë´‰) ë³´ëŸ¬ê°€ê¸°</div>
      </div>
      <div class="info-card-arrow">></div>
    </a>

    <div class="weather-section">
      <div class="weather-header">
        <div class="weather-title">
          ì„¤ì•…ì‚° ë‚ ì”¨
          <span style="font-size: 0.8rem; color: var(--text-muted);">?</span>
        </div>
        <div class="weather-source">ë°ì´í„°ì¶œì²˜: Openweather â€¢ ì‹¤ì‹œê°„</div>
      </div>
      <div class="weather-forecast">
        <div class="weather-day">
          <div class="weather-day-name">11.26 ìˆ˜</div>
          <div class="weather-icon">â˜ï¸</div>
          <div class="weather-temp">1Â°/9Â°</div>
          <div class="weather-wind">í’ì† 2.8m/s</div>
        </div>
        <div class="weather-day">
          <div class="weather-day-name">11.27 ëª©</div>
          <div class="weather-icon">ğŸŒ§ï¸</div>
          <div class="weather-temp">3Â°/8Â°</div>
          <div class="weather-wind">í’ì† 8.1m/s</div>
          <div class="weather-precipitation">ê°•ìˆ˜ëŸ‰ 11.6mm</div>
        </div>
        <div class="weather-day">
          <div class="weather-day-name">11.28 ê¸ˆ</div>
          <div class="weather-icon">â˜€ï¸</div>
          <div class="weather-temp">1Â°/6Â°</div>
          <div class="weather-wind">í’ì† 5.9m/s</div>
        </div>
        <div class="weather-day">
          <div class="weather-day-name">11.29 í† </div>
          <div class="weather-icon">â˜ï¸</div>
          <div class="weather-temp">3Â°/10Â°</div>
          <div class="weather-wind">í’ì† 2.8m/s</div>
        </div>
        <div class="weather-day">
          <div class="weather-day-name">11.30 ì¼</div>
          <div class="weather-icon">ğŸŒ§ï¸</div>
          <div class="weather-temp">9Â°/?</div>
          <div class="weather-wind">í’ì† 7.?</div>
          <div class="weather-precipitation">ê°•ìˆ˜ëŸ‰ 5.?</div>
        </div>
      </div>
      <div class="sun-info">
        <div class="sun-item">
          <span>â˜€ï¸</span>
          <span>ì¼ì¶œ 07:23</span>
        </div>
        <div class="sun-item">
          <span>ğŸŒ™</span>
          <span>ì¼ëª° 17:15</span>
        </div>
      </div>
      <div class="sun-reference">ì¼ì¶œ/ì¼ëª° ê¸°ì¤€ì¼ : 25.11.27</div>
    </div>

    <div class="map-section">
      <div class="map-header">
        <div class="map-title">
          ì„¤ì•…ì‚° ì§€ë„
          <span style="font-size: 0.8rem; color: var(--text-muted);">?</span>
        </div>
        <div class="course-suggest-btn">
          <span style="color: var(--primary);">âœ“</span>
          ì½”ìŠ¤ì œì•ˆ
        </div>
      </div>
      <div class="tabs">
        <button class="tab active">ğŸ”ï¸ ë“±ì‚°ì½”ìŠ¤</button>
      </div>
      <div class="map-container">
        <div id="course-map" style="width: 100%; height: 100%;"></div>
      </div>
      <div class="course-list-header">
        <div class="course-count">ì´ 11ê°œ ì½”ìŠ¤</div>
        <div class="sort-options">
          <button class="sort-btn active">ì¸ê¸°ìˆœ</button>
          <button class="sort-btn">ë‚œì´ë„ìˆœ</button>
          <button class="sort-btn">ì‹œê°„ìˆœ</button>
          <button class="sort-btn">ê±°ë¦¬ìˆœ</button>
        </div>
      </div>
      <div class="course-item">
        <div class="course-item-header">
          <div class="course-name">
            ë°±ìš´ëŒ€ ì½”ìŠ¤
            <span class="course-popular-badge">ì¸ê¸°</span>
          </div>
          <span style="color: var(--text-muted);">></span>
        </div>
        <div class="course-desc">ë¶í•œì‚° ì •ìƒ ë°±ìš´ëŒ€ ìµœë‹¨ ì½”ìŠ¤</div>
        <div class="course-meta">
          <div class="course-meta-item">
            <span class="difficulty">
              <span class="difficulty-bar">
                <span class="filled"></span>
                <span class="filled"></span>
                <span></span>
              </span>
              ë³´í†µ
            </span>
          </div>
          <div class="course-meta-item">ğŸ• 1ì‹œê°„ 30ë¶„</div>
          <div class="course-meta-item">ğŸ”ï¸ 2.0km</div>
        </div>
      </div>
      <div class="course-item">
        <div class="course-item-header">
          <div class="course-name">ë¹„ë´‰ ì½”ìŠ¤</div>
          <span style="color: var(--text-muted);">></span>
        </div>
        <div class="course-desc">ë¹„ë´‰ ì •ìƒê¹Œì§€ì˜ ë“±ì‚° ì½”ìŠ¤</div>
        <div class="course-meta">
          <div class="course-meta-item">
            <span class="difficulty">
              <span class="difficulty-bar">
                <span class="filled"></span>
                <span class="filled"></span>
                <span class="filled"></span>
              </span>
              ì–´ë ¤ì›€
            </span>
          </div>
          <div class="course-meta-item">ğŸ• 1ì‹œê°„</div>
          <div class="course-meta-item">ğŸ”ï¸ 3.0km</div>
        </div>
      </div>
      <div class="course-item">
        <div class="course-item-header">
          <div class="course-name">ì›íš¨ë´‰ ì½”ìŠ¤</div>
          <span style="color: var(--text-muted);">></span>
        </div>
        <div class="course-desc">ì›íš¨ë´‰ ì •ìƒê¹Œì§€ì˜ ë“±ì‚° ì½”ìŠ¤</div>
        <div class="course-meta">
          <div class="course-meta-item">
            <span class="difficulty">
              <span class="difficulty-bar">
                <span class="filled"></span>
                <span></span>
                <span></span>
              </span>
              ì‰¬ì›€
            </span>
          </div>
          <div class="course-meta-item">ğŸ• 1ì‹œê°„</div>
          <div class="course-meta-item">ğŸ”ï¸ 2.7km</div>
        </div>
      </div>
      <div class="course-item">
        <div class="course-item-header">
          <div class="course-name">ì˜ë´‰ ì½”ìŠ¤</div>
          <span style="color: var(--text-muted);">></span>
        </div>
        <div class="course-desc">ì˜ë´‰ ì •ìƒê¹Œì§€ì˜ ë“±ì‚° ì½”ìŠ¤</div>
        <div class="course-meta">
          <div class="course-meta-item">
            <span class="difficulty">
              <span class="difficulty-bar">
                <span class="filled"></span>
                <span class="filled"></span>
                <span></span>
              </span>
              ë³´í†µ
            </span>
          </div>
          <div class="course-meta-item">ğŸ• 1ì‹œê°„ 30ë¶„</div>
          <div class="course-meta-item">ğŸ”ï¸ 2.5km</div>
        </div>
      </div>
      <div class="course-item">
        <div class="course-item-header">
          <div class="course-name">ì§„ë‹¬ë˜ëŠ¥ì„  ì½”ìŠ¤</div>
          <span style="color: var(--text-muted);">></span>
        </div>
        <div class="course-desc">ì§„ë‹¬ë˜ëŠ¥ì„ ì„ ë”°ë¼ê°€ëŠ” ë“±ì‚° ì½”ìŠ¤</div>
        <div class="course-meta">
          <div class="course-meta-item">
            <span class="difficulty">
              <span class="difficulty-bar">
                <span class="filled"></span>
                <span class="filled"></span>
                <span class="filled"></span>
              </span>
              ì–´ë ¤ì›€
            </span>
          </div>
          <div class="course-meta-item">ğŸ• 2ì‹œê°„</div>
          <div class="course-meta-item">ğŸ”ï¸ 4.0km</div>
        </div>
      </div>
    </div>
  </div>

  <a href="mountains-map.html" class="view-all-mountains-btn">
    <span class="view-all-mountains-btn-icon">ğŸ—ºï¸</span>
    ì‚° ì „ì²´ë³´ê¸°
  </a>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Proj4js for coordinate transformation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.9.0/proj4.js"></script>

  <script>
    // proj4js ë¡œë“œ í™•ì¸ ë° í…ŒìŠ¤íŠ¸
    function testProj4() {
      if (!window.proj4) {
        console.error('proj4js not loaded!');
        return false;
      }
      
      // í…ŒìŠ¤íŠ¸ ì¢Œí‘œ ë³€í™˜ (ë¶í•œì‚° ê·¼ì²˜ ì¢Œí‘œ)
      try {
        const source = '+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs';
        const target = '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs';
        const testCoords = window.proj4(source, target, [0, 0]); // ì›ì  í…ŒìŠ¤íŠ¸
        console.log('proj4js test successful, origin transform:', testCoords);
        return true;
      } catch (e) {
        console.error('proj4js test failed:', e);
        return false;
      }
    }

    // ArcGIS ì¢Œí‘œê³„ë¥¼ WGS84ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function transformArcGISToWGS84(x, y) {
      // ITRF2000 TM ì¢Œí‘œê³„ë¥¼ WGS84ë¡œ ë³€í™˜
      const proj4 = window.proj4;
      
      if (!proj4) {
        console.error('proj4js library not loaded');
        return null;
      }
      
      // ì¢Œí‘œê°€ ìœ íš¨í•œì§€ í™•ì¸
      if (x === null || x === undefined || y === null || y === undefined || 
          isNaN(x) || isNaN(y) || Math.abs(x) > 1000000 || Math.abs(y) > 1000000) {
        console.warn('Invalid input coordinates:', x, y);
        return null;
      }
      
      // ITRF2000 TM ì¢Œí‘œê³„ ì •ì˜ (í•œêµ­ ì¤‘ë¶€ì›ì  EPSG:5186)
      // ì¢Œí‘œê³„: GRS80 / TM ì¤‘ë¶€ì›ì 
      const source = 'EPSG:5186'; // ë˜ëŠ” '+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +units=m +no_defs';
      const target = 'EPSG:4326'; // WGS84
      
      try {
        // proj4jsê°€ EPSG ì½”ë“œë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©´ ì§ì ‘ ì •ì˜ ì‚¬ìš©
        let sourceDef = source;
        let targetDef = target;
        
        // í•œêµ­ TM ì¢Œí‘œê³„ (ì¤‘ë¶€ì›ì  EPSG:5186)
        // ITRF2000 TM ì¢Œí‘œê³„: x_0=200000, y_0=600000, lon_0=127, lat_0=38
        // ì…ë ¥ ì¢Œí‘œëŠ” ì´ë¯¸ ì›ì  ê¸°ì¤€ì´ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
        // í•˜ì§€ë§Œ xê°€ ìŒìˆ˜ì¸ ê²½ìš°ë¥¼ ê³ ë ¤í•˜ì—¬ ì›ì  ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜
        // ì‹¤ì œë¡œëŠ” ì¢Œí‘œê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì•¼ í•¨
        
        // ITRF2000 TM ì¢Œí‘œê³„ ì •ì˜
        // WKT: PROJCS["PCS_ITRF2000_TM", ... PARAMETER["False_Easting",200000.0], PARAMETER["False_Northing",600000.0]
        // ì…ë ¥ ì¢Œí‘œëŠ” ì´ë¯¸ ì›ì (200000, 600000) ê¸°ì¤€ì´ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
        // í•˜ì§€ë§Œ ë³€í™˜ ê²°ê³¼ê°€ ì˜ëª» ë‚˜ì˜¤ëŠ” ê²½ìš°ë¥¼ ëŒ€ë¹„í•´ ì¢Œí‘œê³„ ì •ì˜ë¥¼ ì •í™•íˆ ì„¤ì •
        
        // ITRF2000ê³¼ WGS84ëŠ” ê±°ì˜ ë™ì¼í•˜ì§€ë§Œ, datum ë³€í™˜ì„ ìœ„í•´ towgs84 íŒŒë¼ë¯¸í„° ì‚¬ìš©
        // ì‹¤ì œë¡œëŠ” ITRF2000ê³¼ WGS84ê°€ ë§¤ìš° ìœ ì‚¬í•˜ë¯€ë¡œ towgs84ëŠ” ê±°ì˜ 0
        sourceDef = '+proj=tmerc +lat_0=38 +lon_0=127 +k=1 +x_0=200000 +y_0=600000 +ellps=GRS80 +datum=WGS84 +units=m +no_defs';
        targetDef = '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs';
        
        // ì¢Œí‘œ ë³€í™˜ ì‹¤í–‰
        const result = proj4(sourceDef, targetDef, [x, y]);
        const lon = result[0];
        const lat = result[1];
        
        // ë””ë²„ê¹…: ë³€í™˜ ê²°ê³¼ í™•ì¸ ë° ìˆ˜ì •
        if (Math.abs(x + 556.61) < 1) {
          console.log('Coordinate transformation debug:', {
            input: [x, y],
            output: [lon, lat],
            expected: 'lon ~127.0, lat ~37.65',
            difference: {
              lon: Math.abs(lon - 127.0),
              lat: Math.abs(lat - 37.65)
            }
          });
          
          // ë³€í™˜ ê²°ê³¼ê°€ ì˜ëª»ëœ ê²½ìš° (ê²½ë„ê°€ 124-125 ë²”ìœ„ë©´ ì˜ëª»ë¨)
          if (lon < 126 || lon > 128) {
            console.warn('Coordinate transformation seems incorrect, trying alternative method');
            // ëŒ€ì•ˆ: ì¢Œí‘œë¥¼ ì›ì  ê¸°ì¤€ìœ¼ë¡œ ë³€í™˜
            const adjustedX = 200000 + x;
            const adjustedY = y; // yëŠ” ì´ë¯¸ ì›ì  ê¸°ì¤€
            const altResult = proj4(sourceDef, targetDef, [adjustedX, adjustedY]);
            console.log('Alternative transformation:', {
              adjustedInput: [adjustedX, adjustedY],
              output: altResult
            });
            // ëŒ€ì•ˆ ê²°ê³¼ê°€ ë” ì •í™•í•˜ë©´ ì‚¬ìš©
            if (altResult[0] >= 126 && altResult[0] <= 128) {
              return [altResult[1], altResult[0]]; // [lat, lon]
            }
          }
        }
        
        // ë””ë²„ê¹…: ì²« ë²ˆì§¸ ì¢Œí‘œë§Œ ìƒì„¸ ë¡œê·¸
        if (Math.abs(x + 556.61) < 1 && Math.abs(y - 599815.69) < 100) {
          console.log('First point transformation:', {
            input: [x, y],
            output: [lon, lat],
            expected: 'lon ~127.0, lat ~37.65'
          });
        }
        
        // ì¢Œí‘œ ìœ íš¨ì„± ê²€ì‚¬ (í•œêµ­ ì˜ì—­: ìœ„ë„ 33-43, ê²½ë„ 124-132)
        if (lat >= 33 && lat <= 43 && lon >= 124 && lon <= 132) {
          return [lat, lon];
        } else {
          console.warn('Coordinates out of Korea range:', lat, lon, 'Input:', x, y);
          return null;
        }
      } catch (e) {
        console.error('Coordinate transformation error:', e, 'Input:', x, y);
        return null;
      }
    }

    // ArcGIS í˜•ì‹ì˜ GeoJSONì„ Leafletì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜
    function convertArcGISToGeoJSON(arcgisData) {
      const features = arcgisData.features || [];
      let validFeaturesCount = 0;
      
      const geoJSONFeatures = features.map((feature, index) => {
        const attrs = feature.attributes || {};
        let geometry = null;
        let validCoords = [];

        if (feature.geometry) {
          if (feature.geometry.paths) {
            // Polyline (ë“±ì‚°ë¡œ)
            const paths = feature.geometry.paths;
            
            paths.forEach((path, pathIndex) => {
              const convertedPath = [];
              let validPointCount = 0;
              
              path.forEach((point, pointIndex) => {
                if (Array.isArray(point) && point.length >= 2) {
                  const x = point[0];
                  const y = point[1];
                  const coords = transformArcGISToWGS84(x, y);
                  
                  if (coords && coords[0] && coords[1] && !isNaN(coords[0]) && !isNaN(coords[1])) {
                    // GeoJSON í˜•ì‹: [lon, lat] - Leafletì˜ L.geoJSONì€ GeoJSON í‘œì¤€ì„ ë”°ë¦„
                    convertedPath.push([coords[1], coords[0]]);
                    validPointCount++;
                    
                    // ì²˜ìŒ 5ê°œ í¬ì¸íŠ¸ ë¡œê·¸ ì¶œë ¥
                    if (pointIndex < 5 && pathIndex === 0 && index === 0) {
                      console.log(`Feature ${index}, Path ${pathIndex}, Point ${pointIndex}: [${x}, ${y}] -> [${coords[1]}, ${coords[0]}]`);
                    }
                  } else if (pointIndex < 5) {
                    // ì²˜ìŒ 5ê°œ í¬ì¸íŠ¸ë§Œ ë¡œê·¸ ì¶œë ¥
                    console.warn(`Failed to convert point ${pointIndex} in path ${pathIndex}:`, x, y, '->', coords);
                  }
                }
              });
              
              if (convertedPath.length > 0) {
                console.log(`Path ${pathIndex}: Converted ${validPointCount}/${path.length} points`);
                validCoords.push(convertedPath);
              } else {
                console.warn(`Path ${pathIndex}: No valid points after conversion`);
              }
            });

            if (validCoords.length > 0) {
              // ì—¬ëŸ¬ ê²½ë¡œê°€ ìˆìœ¼ë©´ MultiLineStringìœ¼ë¡œ ë³€í™˜, í•˜ë‚˜ë©´ LineString
              if (validCoords.length === 1) {
                geometry = {
                  type: 'LineString',
                  coordinates: validCoords[0]
                };
              } else {
                geometry = {
                  type: 'MultiLineString',
                  coordinates: validCoords
                };
              }
              validFeaturesCount++;
            }
          } else if (feature.geometry.x !== undefined && feature.geometry.y !== undefined) {
            // Point (ë“±ì‚° ì§€ì )
            const coords = transformArcGISToWGS84(feature.geometry.x, feature.geometry.y);
            if (coords && coords[0] && coords[1]) {
              geometry = {
                type: 'Point',
                coordinates: [coords[1], coords[0]] // GeoJSON í˜•ì‹: [lon, lat]
              };
              validFeaturesCount++;
            }
          }
        }

        if (geometry) {
          return {
            type: 'Feature',
            properties: attrs,
            geometry: geometry
          };
        }
        return null;
      }).filter(f => f !== null);

      console.log(`Converted ${validFeaturesCount} valid features out of ${features.length} total features`);

      return {
        type: 'FeatureCollection',
        features: geoJSONFeatures
      };
    }

    // ì§€ë„ ì´ˆê¸°í™”
    function initMap() {
      // ì§€ë„ ì»¨í…Œì´ë„ˆê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
      const mapContainer = document.getElementById('course-map');
      if (!mapContainer) {
        console.error('Map container not found');
        return;
      }

      // ì§€ë„ ì»¨í…Œì´ë„ˆ í¬ê¸° í™•ì¸ ë° ì„¤ì •
      mapContainer.style.width = '100%';
      mapContainer.style.height = '100%';

      // ì„¤ì•…ì‚° ì¤‘ì‹¬ ì¢Œí‘œ (ëŒ€ì²­ë´‰ ê¸°ì¤€) - í•­ìƒ ê³ ì •
      const seoraksanCenter = [38.1214, 128.4656];
      const seoraksanZoom = 13;
      
      const map = L.map('course-map', {
        center: seoraksanCenter,
        zoom: seoraksanZoom,
        zoomControl: true,
        minZoom: 3,
        maxZoom: 18
      });

      // OpenStreetMap íƒ€ì¼ ë ˆì´ì–´ ì¶”ê°€
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors',
        maxZoom: 19
      }).addTo(map);

      // proj4js ë¡œë“œ í™•ì¸
      setTimeout(() => {
        if (!testProj4()) {
          console.error('proj4js library failed to load or test');
          document.getElementById('course-map').innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-muted);">ì§€ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
          return;
        }
      }, 200);

      // ì§€ë„ í¬ê¸° ì¡°ì • ë° ë¶í•œì‚° ìœ„ì¹˜ ê³ ì •
      setTimeout(() => {
        map.invalidateSize();
        // í•­ìƒ ì„¤ì•…ì‚° ìœ„ì¹˜ë¡œ ê³ ì •
        map.setView(seoraksanCenter, seoraksanZoom);
      }, 100);

      // ê³µê³µë°ì´í„° API í‚¤
      const API_KEY = 'a5b90c3d255059985fd6b76e19caf35149e39a536c3d5ab10320c006b3c5dc60';
      const MOUNTAIN_CODE = '428302602'; // ì„¤ì•…ì‚° ì½”ë“œ

      // ê³µê³µë°ì´í„° APIì—ì„œ ë“±ì‚°ë¡œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      function loadCourseDataFromAPI() {
        // ê³µê³µë°ì´í„° API URL - ì„¤ì•…ì‚°ì˜ ëª¨ë“  ë“±ì‚°ë¡œ ê°€ì ¸ì˜¤ê¸°
        // ë“±ì‚°ë¡œ ì •ë³´ API - numOfRowsë¥¼ í¬ê²Œ ì„¤ì •í•˜ì—¬ ëª¨ë“  ì½”ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        const courseApiUrl = `https://apis.data.go.kr/1400000/service/cultureInfoService/mntInfoOpenAPI?serviceKey=${encodeURIComponent(API_KEY)}&mntnListNo=${MOUNTAIN_CODE}&numOfRows=1000&pageNo=1&_type=json`;
        
        console.log('Loading course data from API...', courseApiUrl);
        
        // ê³µê³µë°ì´í„° API í˜¸ì¶œ ì‹œë„
        fetch(courseApiUrl)
          .then(response => {
            console.log('API response status:', response.status);
            if (!response.ok) {
              throw new Error(`API request failed: ${response.status}`);
            }
            return response.json();
          })
          .then(apiData => {
            console.log('API data received:', apiData);
            // API ì‘ë‹µ í˜•ì‹ì— ë”°ë¼ ë°ì´í„° ì²˜ë¦¬
            if (apiData.response && apiData.response.body && apiData.response.body.items) {
              const items = apiData.response.body.items.item;
              const itemArray = Array.isArray(items) ? items : [items];
              console.log('API items found:', itemArray.length);
              
              if (itemArray.length > 0) {
                // APIì—ì„œ ì—¬ëŸ¬ ì½”ìŠ¤ë¥¼ ê°€ì ¸ì™”ì§€ë§Œ, GeoJSON í˜•ì‹ì´ ì•„ë‹ˆë¯€ë¡œ
                // ë¡œì»¬ íŒŒì¼ì„ ì‚¬ìš©í•˜ë˜, ì—¬ëŸ¬ ì½”ìŠ¤ë¥¼ í‘œì‹œí•˜ê¸° ìœ„í•´
                // APIì—ì„œ ê°€ì ¸ì˜¨ ì½”ìŠ¤ ì •ë³´ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŒ
                console.log('API returned', itemArray.length, 'courses');
                console.log('Course names from API:', itemArray.map(item => item.PMNTN_NM || 'N/A'));
                
                // ì¼ë‹¨ ë¡œì»¬ GeoJSON íŒŒì¼ ì‚¬ìš© (í–¥í›„ APIì—ì„œ GeoJSON ì§ì ‘ ê°€ì ¸ì˜¤ê¸° ê°€ëŠ¥)
                return fetch('mountain/428302602_geojson/PMNTN_ì„¤ì•…ì‚°_ëŒ€ì²­ë´‰_428302602.json').then(r => r.json());
              } else {
                console.warn('No items in API response');
                return fetch('mountain/428302602_geojson/PMNTN_ì„¤ì•…ì‚°_ëŒ€ì²­ë´‰_428302602.json').then(r => r.json());
              }
            } else {
              // API ì‘ë‹µì´ ì˜ˆìƒê³¼ ë‹¤ë¥´ë©´ ë¡œì»¬ GeoJSON íŒŒì¼ ì‚¬ìš©
              console.warn('Unexpected API response format, using local GeoJSON file');
              console.log('API response structure:', Object.keys(apiData));
              return fetch('mountain/287201304_geojson/PMNTN_100ê³ ì§€_287201304.json').then(r => r.json());
            }
          })
          .catch(apiError => {
            console.warn('API request failed, using local GeoJSON file:', apiError);
            // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ë¡œì»¬ GeoJSON íŒŒì¼ ì§ì ‘ ì‚¬ìš©
            console.log('Loading local file: mountain/428302602_geojson/PMNTN_ì„¤ì•…ì‚°_ëŒ€ì²­ë´‰_428302602.json');
            return fetch('mountain/428302602_geojson/PMNTN_ì„¤ì•…ì‚°_ëŒ€ì²­ë´‰_428302602.json')
              .then(response => {
                console.log('Local file response status:', response.status);
                if (!response.ok) {
                  throw new Error(`Failed to load course data: ${response.status} ${response.statusText}`);
                }
                return response.json();
              })
              .then(data => {
                console.log('Local file loaded successfully, features:', data.features?.length || 0);
                return data;
              });
          })
          .then(data => {
            console.log('Course data loaded:', data);
            console.log('Course data loaded, features:', data.features?.length || 0);
            
            if (!data || !data.features || data.features.length === 0) {
              console.error('No features found in data!');
              return;
            }
            
            const geoJSON = convertArcGISToGeoJSON(data);
            console.log('Converted GeoJSON:', geoJSON);
            console.log('Converted GeoJSON features:', geoJSON.features?.length || 0);
            
            if (geoJSON.features && geoJSON.features.length > 0) {
              console.log('Adding course layer to map...');
              console.log('First feature coordinates:', geoJSON.features[0].geometry?.coordinates?.slice(0, 3));
              
              // ë“±ì‚°ë¡œë¥¼ ì§€ë„ì— í‘œì‹œ
              const courseLayer = L.geoJSON(geoJSON, {
                style: {
                  color: '#2d8659',
                  weight: 4,
                  opacity: 0.8
                },
                onEachFeature: function(feature, layer) {
                  if (feature.properties) {
                    const props = feature.properties;
                    const popupContent = `
                      <div style="padding: 8px;">
                        <h4 style="margin: 0 0 8px 0; font-size: 1rem;">${props.PMNTN_NM || 'ë“±ì‚°ë¡œ'}</h4>
                        <p style="margin: 4px 0; font-size: 0.85rem;"><strong>êµ¬ê°„:</strong> ${props.PMNTN_MAIN || '-'}</p>
                        <p style="margin: 4px 0; font-size: 0.85rem;"><strong>ê±°ë¦¬:</strong> ${props.PMNTN_LT || '-'}km</p>
                        <p style="margin: 4px 0; font-size: 0.85rem;"><strong>ë‚œì´ë„:</strong> ${props.PMNTN_DFFL || '-'}</p>
                        <p style="margin: 4px 0; font-size: 0.85rem;"><strong>ìƒí–‰:</strong> ${props.PMNTN_UPPL || '-'}m</p>
                        <p style="margin: 4px 0; font-size: 0.85rem;"><strong>í•˜í–‰:</strong> ${props.PMNTN_GODN || '-'}m</p>
                      </div>
                    `;
                    layer.bindPopup(popupContent);
                  }
                }
              }).addTo(map);
              
              console.log('Course layer added to map, layer count:', map._layers ? Object.keys(map._layers).length : 0);
              console.log('Course layer bounds:', courseLayer.getBounds());

              // ë“±ì‚°ë¡œê°€ ìˆìœ¼ë©´ ë²”ìœ„ ì¡°ì •, ì—†ìœ¼ë©´ ë¶í•œì‚° ìœ„ì¹˜ ìœ ì§€
              setTimeout(() => {
                try {
                  const bounds = courseLayer.getBounds();
                  if (bounds && bounds.isValid && bounds.isValid()) {
                    const sw = bounds.getSouthWest();
                    const ne = bounds.getNorthEast();
                    
                    console.log('Course bounds:', {
                      southWest: { lat: sw.lat, lng: sw.lng },
                      northEast: { lat: ne.lat, lng: ne.lng }
                    });
                    
                    // ì„¤ì•…ì‚° ì˜ì—­ í™•ì¸
                    // ì‹¤ì œ ì„¤ì•…ì‚°: ê²½ë„ 128.3-128.6, ìœ„ë„ 38.0-38.3
                    const isInSeoraksanArea = 
                      (sw.lat >= 37.5 && sw.lat <= 38.5 && 
                       sw.lng >= 128.0 && sw.lng <= 129.0 &&
                       ne.lat >= 37.5 && ne.lat <= 38.5 && 
                       ne.lng >= 128.0 && ne.lng <= 129.0);
                    
                    if (isInSeoraksanArea) {
                      // ë“±ì‚°ë¡œê°€ ì„¤ì•…ì‚° ì˜ì—­ ë‚´ì— ìˆìœ¼ë©´ ë²”ìœ„ ì¡°ì •
                      map.fitBounds(bounds, { 
                        padding: [50, 50],
                        maxZoom: 16
                      });
                      console.log('Map bounds adjusted to course:', bounds.toBBoxString());
                    } else {
                      console.warn('Bounds out of Seoraksan area:', {
                        sw: { lat: sw.lat, lng: sw.lng },
                        ne: { lat: ne.lat, lng: ne.lng }
                      });
                      // ì¢Œí‘œ ë³€í™˜ ë¬¸ì œì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì²« ë²ˆì§¸ ì¢Œí‘œë¥¼ í™•ì¸
                      const firstFeature = geoJSON.features[0];
                      if (firstFeature && firstFeature.geometry && firstFeature.geometry.coordinates) {
                        const firstCoord = firstFeature.geometry.coordinates[0];
                        console.log('First coordinate:', firstCoord);
                      }
                      // ì„¤ì•…ì‚° ìœ„ì¹˜ ìœ ì§€
                      map.setView([38.1214, 128.4656], 13);
                    }
                  } else {
                    console.warn('Invalid bounds for course layer, keeping default view');
                    // ì„¤ì•…ì‚° ìœ„ì¹˜ ìœ ì§€
                    map.setView([38.1214, 128.4656], 13);
                  }
                } catch (e) {
                  console.error('Error adjusting map bounds:', e);
                  // ì„¤ì•…ì‚° ìœ„ì¹˜ ìœ ì§€
                  map.setView([38.1214, 128.4656], 13);
                }
              }, 1000);
            } else {
              console.error('No features found in GeoJSON!');
              console.error('geoJSON object:', geoJSON);
              console.error('geoJSON.features:', geoJSON.features);
            }
          })
          .catch(error => {
            console.error('Error loading course data:', error);
            document.getElementById('course-map').innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--text-muted);">ë“±ì‚° ì½”ìŠ¤ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</div>';
          });
      }

      // ê³µê³µë°ì´í„° API ì§ì ‘ í˜¸ì¶œ (ë°±ì—”ë“œ í”„ë¡ì‹œ í•„ìš”)
      function loadCourseFromPublicAPI() {
        const API_KEY = 'a5b90c3d255059985fd6b76e19caf35149e39a536c3d5ab10320c006b3c5dc60';
        const MOUNTAIN_CODE = '428302602';
        
        // ê³µê³µë°ì´í„° APIëŠ” CORS ì œí•œì´ ìˆì–´ì„œ ì§ì ‘ í˜¸ì¶œì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤
        // ë°±ì—”ë“œ ì„œë²„ë¥¼ í†µí•´ í”„ë¡ì‹œë¡œ í˜¸ì¶œí•˜ê±°ë‚˜, 
        // ê³µê³µë°ì´í„°í¬í„¸ì—ì„œ ì œê³µí•˜ëŠ” GeoJSON ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
        
        // ì˜ˆì‹œ: GeoJSON ì„œë¹„ìŠ¤ URL (ì‹¤ì œ API ì—”ë“œí¬ì¸íŠ¸ì— ë§ê²Œ ìˆ˜ì • í•„ìš”)
        const geojsonUrl = `https://api.odcloud.kr/api/15000516/v1/uddi:428302602?serviceKey=${encodeURIComponent(API_KEY)}`;
        
        // ë˜ëŠ” ë¡œì»¬ íŒŒì¼ ì‚¬ìš©
        console.log('API Key configured:', API_KEY.substring(0, 20) + '...');
        console.log('Note: Public Data API requires backend proxy due to CORS restrictions');
      }

      // ë“±ì‚° ì§€ì  ë°ì´í„° ë¡œë“œ
      function loadSpotData() {
        fetch('mountain/428302602_geojson/PMNTN_SPOT_ì„¤ì•…ì‚°_ëŒ€ì²­ë´‰_428302602.json')
          .then(response => response.json())
          .then(data => {
            const geoJSON = convertArcGISToGeoJSON(data);
            
            if (geoJSON.features.length > 0) {
              L.geoJSON(geoJSON, {
                pointToLayer: function(feature, latlng) {
                  return L.marker(latlng, {
                    icon: L.divIcon({
                      className: 'course-spot-marker',
                      html: '<div style="background: #ff4444; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);"></div>',
                      iconSize: [12, 12]
                    })
                  });
                },
                onEachFeature: function(feature, layer) {
                  if (feature.properties) {
                    const props = feature.properties;
                    const popupContent = `
                      <div style="padding: 8px;">
                        <h4 style="margin: 0 0 8px 0; font-size: 1rem;">${props.DETAIL_SPO || 'ë“±ì‚° ì§€ì '}</h4>
                        ${props.ETC_MATTER ? `<p style="margin: 4px 0; font-size: 0.85rem;">${props.ETC_MATTER}</p>` : ''}
                      </div>
                    `;
                    layer.bindPopup(popupContent);
                  }
                }
              }).addTo(map);
            }
          })
          .catch(error => {
            console.error('Error loading spot data:', error);
          });
      }

      // ë°ì´í„° ë¡œë“œ
      loadCourseDataFromAPI();
      loadSpotData();
    }

    // í˜ì´ì§€ ë¡œë“œ í›„ ì§€ë„ ì´ˆê¸°í™”
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initMap);
    } else {
      // DOMì´ ì´ë¯¸ ë¡œë“œëœ ê²½ìš°
      setTimeout(initMap, 100);
    }
  </script>
</body>
</html>

