# =================================================
# Daily Report CronJob
# =================================================
apiVersion: batch/v1
kind: CronJob
metadata:
  name: daily-report
  namespace: bravo-ai-integration-ns
spec:
  schedule: "0 0 * * *"  # 매일 자정
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            sidecar.istio.io/inject: "false"
        spec:
          serviceAccountName: ai-infra-service
          tolerations:
          - key: node-role.kubernetes.io/control-plane
            operator: Exists
            effect: NoSchedule
          containers:
          - name: report-generator
            image: 192.168.0.244:30305/bravo/hiking-ai-infra-service:latest
            imagePullPolicy: IfNotPresent
            command: ["node", "/app/services/report-script.js", "daily"]
            resources:
              requests:
                memory: "1Gi"
                cpu: "500m"
              limits:
                memory: "3Gi"
                cpu: "2"
            envFrom:
            - configMapRef:
                name: ai-infra-config
            - secretRef:
                name: ai-infra-secrets
          restartPolicy: OnFailure

